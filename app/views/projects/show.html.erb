
<div class="home-box">
	<button class="button-green" id="ne">Next Project</button>
	<h1><%=@project.name%></h1>
	<%= render partial: "projects/table", locals: {delete_privelage: true} %>
	<h3><a href='/projects/<%="#{@project.id}"%>/tasks/new'><button class='button-green'>Add Task</button></a></h3><br>
	<h3><a data-confirm="You sure you want to delete this project?" rel="nofollow" data-method="delete" href='/projects/<%="#{@project.id}"%>'><button class='button-red'>Delete Project</button></a></h3>
</div>

<button id='loads-current' class='loads-current-user' hidden onclick="loadTasks()">Show Tasks</button>

<script>
					
	function loadTasks() {
		$(".loads-current-user").hide()
		let results = []
		$("#headers").show()
		var arr = window.location.toString().split('/')
		var project_id = arr[arr.length - 1]
		$.get( "/projects/" + project_id + ".json", function( data ) {
			data["tasks"].forEach(function(el) {
			  results.push(el)
			})
			var i = 0
			for (i = 0; i < results.length; i++){
				if (results[i]["admin"] != true){
					var task = {}
					task = new Task(results[i]["filled"], results[i]["admin"], results[i]["username"], results[i]["user_id"], results[i]["role"], project_id)
					$("#task-table").append("<%= j render partial: 'projects/task' %>");
					task.setInformation()
					if (current_id === results[0]["user_id"]){
						$(".delete").last().append("<h3><button class='button-red'>Delete</button></h3>")
					}
				}
			}
		});		
	}
</script>